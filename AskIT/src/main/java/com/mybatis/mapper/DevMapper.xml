<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="dev">
 
      <!-- Í≤åÏãúÎ¨º Î¶¨Ïä§Ìä∏  Ï°∞Ìöå -->
   <select id = "selectAllAsk" resultType = "ArticleListDTO" parameterType="ArticleListDTO">
	<!-- ÎåìÍ∏Ä Ìè¨Ìï®ÌïòÏßÄÏïäÏùÄ Í≤åÏãúÍ∏Ä Î™©Î°ùÌéòÏù¥ÏßÄ -->
		SELECT 
		A.ARTICLE_NUM, 
		A.ARTICLE_TITLE, 
		A.ARTICLE_TEXT, 
		A.ARTICLE_DATE, 
		A.ARTICLE_VIEW, 
		A.ARTICLE_MONITER_NUM, 
		A.ARTICLE_TOPCATE, 
		A.ARTICLE_BOTCATE, 
		A.ARTICLE_TAGNAME, 
		U.USER_NICK,
		CASE WHEN USER_CERT = 'T' THEN 'üèÖ' END AS badge
		FROM TBL_ARTICLE A
		JOIN TBL_USER U ON A.USER_NUM = U.USER_NUM
		WHERE ((A.ARTICLE_TOPCATE) = 'Í∞úÎ∞ú'AND (A.ARTICLE_BOTCATE) = 'ÏßàÎ¨∏')
		ORDER BY A.ARTICLE_DATE DESC
   </select>
   
         <!-- Í≤åÏãúÎ¨º Î¶¨Ïä§Ìä∏  Ï°∞Ìöå -->
   <select id = "selectAllTip" resultType = "ArticleListDTO" parameterType="ArticleListDTO">
	<!-- ÎåìÍ∏Ä Ìè¨Ìï®ÌïòÏßÄÏïäÏùÄ Í≤åÏãúÍ∏Ä Î™©Î°ùÌéòÏù¥ÏßÄ -->
		
		SELECT 
		A.ARTICLE_NUM, 
		A.ARTICLE_TITLE, 
		A.ARTICLE_TEXT, 
		A.ARTICLE_DATE, 
		A.ARTICLE_VIEW, 
		A.ARTICLE_MONITER_NUM, 
		A.ARTICLE_TOPCATE, 
		A.ARTICLE_BOTCATE, 
		A.ARTICLE_TAGNAME, 
		U.USER_NICK,
		CASE WHEN USER_CERT = 'T' THEN 'üèÖ' END AS badge
		FROM TBL_ARTICLE A
		JOIN TBL_USER U ON A.USER_NUM = U.USER_NUM
		WHERE ((A.ARTICLE_TOPCATE) = 'Í∞úÎ∞ú'AND (A.ARTICLE_BOTCATE) = 'ÍøÄÌåÅ')
		ORDER BY A.ARTICLE_DATE DESC
   </select>
   
      <!--Í≤åÏãúÎ¨º ÏÉÅÏÑ∏ÌéòÏù¥ÏßÄ  Ï°∞Ìöå-->
   <select id = "selectOne" resultType = "ArticleListDTO" parameterType="int">
		<!-- ÎåìÍ∏Ä Ìè¨Ìï®ÌïòÏßÄÏïäÏùÄ Í≤åÏãúÍ∏Ä Î™©Î°ùÌéòÏù¥ÏßÄ -->
		SELECT 
		A.ARTICLE_NUM, 
		U.USER_NICK,
		A.ARTICLE_TITLE, 
		A.ARTICLE_TEXT, 
		A.ARTICLE_DATE, 
		A.ARTICLE_VIEW, 
		A.ARTICLE_MONITER_NUM, 
		A.ARTICLE_TOPCATE, 
		A.ARTICLE_BOTCATE, 
		A.ARTICLE_TAGNAME,
		CASE WHEN USER_CERT = 'T' THEN 'üèÖ' END AS badge
		FROM TBL_ARTICLE A
		JOIN TBL_USER U ON A.USER_NUM = U.USER_NUM
		AND A.ARTICLE_NUM = #{articleNum}
   </select>
   
   <!--   Í≤åÏãúÎ¨º ÏÇ≠Ï†ú -->
    <delete id ="delete" parameterType = "int">
     DELETE 
     FROM TBL_ARTICLE
     WHERE article_num = #{articleNum}
    </delete>
  
   <!--  Í≤åÏãúÎ¨º ÏàòÏ†ï -->
    <update id="update" parameterType = "ArticleDetailDTO">
      UPDATE 
      TBL_ARTICLE
      SET
	  article_title = #{articleTitle},	
      ARTICLE_TEXT = #{articleText} 
      WHERE article_num = #{articleNum} 
    </update>
   
    <!-- Ï°∞ÌöåÏàò Ï¶ùÍ∞Ä -->
   <update id="increaseView" parameterType = "int">
    UPDATE tbl_article 
    SET  article_view = article_view + 1 
    WHERE article_num = #{articleNum}
   </update> 
   
   
    <select id="comment" parameterType="int" resultType="CommentDTO">
	SELECT 
    C.COMMENT_NUM,                     
    C.USER_NUM,                    
    U.USER_NAME,                     
    U.USER_NICK,                   
    C.COMMENT_TEXT,                 
    C.COMMENT_MONITOR_NUM,         
    C.COMMENT_DATE,             
    U.USER_MONITER AS USER_MONITER,
    U.user_nick 
	FROM 
	    TBL_COMMENT C
	JOIN 
	    TBL_USER U ON C.USER_NUM = U.USER_NUM  
	WHERE 
	    C.ARTICLE_NUM = #{articleNum}                  
	ORDER BY 
	    C.COMMENT_DATE DESC       

    </select> 
	
    
	<insert id="commmentUpdate" parameterType="CommentDTO">
        INSERT INTO TBL_comment (comment_num, comment_text, user_num, comment_date)
        VALUES (#{commentNum}, #{commentText}, #{userNum}, #{commentDate})
    </insert>
	
</mapper>
   

   


   
 


   
   

